<!DOCTYPE html>
<html>
<head>
  <title>Detox & Classify Tester (HF Space)</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f9f9f9; padding: 40px; text-align: center; }
    textarea { width: 80%; height: 100px; padding: 10px; font-size: 1em; border-radius: 6px; border: 1px solid #ccc; }
    button { margin: 10px; padding: 10px 20px; font-size: 1em; border: none; border-radius: 6px; cursor: pointer; }
    .detox { background: #27ae60; color: white; }
    .classify { background: #2980b9; color: white; }
    pre { background: #fff; padding: 15px; border: 1px solid #ddd; border-radius: 8px; text-align: left; display: inline-block; margin-top: 20px; }
  </style>
</head>
<body>
  <h1>Hugging Face Detox & Classify Tester</h1>
  <textarea id="inputText" placeholder="Enter text here..."></textarea><br>
  <label>
  Confidence Threshold:
  <input type="number" id="threshold" value="0.5" step="0.05" min="0" max="1">
</label><br>
  <button class="detox" onclick="sendRequest('detoxify')">Detoxify</button>
  <button class="classify" onclick="sendRequest('classify')">Classify</button>
  <div id="result"></div>

<script>
  const API_BASE = "https://TechKid0109-Detox-Extension.hf.space";

  async function sendRequest(endpoint) {
    const text = document.getElementById("inputText").value;
    const threshold = parseFloat(document.getElementById("threshold").value) || 0.5;

    document.getElementById("result").innerHTML = "<p>Loading...</p>";
    try {
      // Build request body
      let body = { text };
      if (endpoint === "classify") {
        body.threshold = threshold;
      }

      const res = await fetch(`${API_BASE}/${endpoint}`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(body)
      });
      const data = await res.json();

      // Pretty print response
      let output = "<pre>" + JSON.stringify(data, null, 2) + "</pre>";

      // If classify, show confidence breakdown
      if (endpoint === "classify" && data.confidence) {
        output += "<h4>Confidence Scores</h4><ul>";
        for (const [label, score] of Object.entries(data.confidence)) {
          output += `<li>${label}: ${(score * 100).toFixed(2)}%</li>`;
        }
        output += "</ul>";
      }

      document.getElementById("result").innerHTML = output;
    } catch (err) {
      document.getElementById("result").innerHTML =
        `<pre>{ "error": "${err.message}" }</pre>`;
    }
  }
</script>
</body>
</html>